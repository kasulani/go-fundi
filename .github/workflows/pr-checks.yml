name: PR Check

on:
  pull_request:
    branches: [ master ]

jobs:
  branch-name:
    name: Check Branch Naming Convention
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Validate Branch Name
        run: |
          branch_name="${GITHUB_HEAD_REF}"
          echo "Checking branch name: $branch_name"
          if [[ ! "$branch_name" =~ ^(Minor|minor|Major|major|Patch|patch|Test|test|Chore|chore)/.+$ ]]; then
            echo "Error: Branch name '$branch_name' does not follow the convention 'type/branch-name'."
            echo "Allowed types: Minor/minor, Major/major, Patch/patch, Test/test, Chore/chore."
            exit 1
          fi
          echo "Branch name '$branch_name' is valid."

  pr-title:
    name: Check Pull Request Title Format
    runs-on: ubuntu-latest
    steps:
      - name: Validate PR Title
        run: |
          pr_title="${{ github.event.pull_request.title }}"
          echo "Checking PR title: $pr_title"
          if [[ ! "$pr_title" =~ ^(Minor|minor|Major|major|Patch|patch|Test|test|Chore|chore):\ .+ ]]; then
            echo "Error: PR title '$pr_title' does not follow the format 'type: PR title'."
            echo "Allowed types: Minor/minor, Major/major, Patch/patch, Test/test, Chore/chore."
            exit 1
          fi
          echo "PR title '$pr_title' is valid."
